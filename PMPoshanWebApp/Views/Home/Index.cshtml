@using System.Net
@using System.IO
@using PMPoshanWebApp.Helpers
@model PMPoshanWebApp.Integrations.EMIS.Models.HomePageViewModel
@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";

}

<style>
    .rate-content br {
        display: block;
        content: "";
        margin-bottom: 0.6rem;
    }

    .gallery-tab.active {
        background-color: #0d47a1 ;
        color: white;
        border-color: #0d47a1;
    }
</style>



@await Html.PartialAsync("_pvHeroSection", Model.Banners)


<!-- About Us Section -->
<section class="py-16 md:py-24 bg-background-light" id="about">
    <div class="container mx-auto max-w-5xl px-4">
        <div class="grid grid-cols-1 items-center gap-10 md:grid-cols-2 md:gap-16">
            <div class="order-2 md:order-1">
                <h2 class="text-3xl font-bold text-primary md:text-4xl">
                    @Model.AboutUs.KCMContentName
                </h2>
                <p class="mt-4 text-base leading-relaxed text-text-body">
                    @Html.Raw(WebUtility.HtmlDecode(@Model.AboutUs.KCMContent))
                    
                </p>
            </div>
            <div class="order-1 md:order-2">
                <div class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-xl shadow-lg"
                     data-alt="A photograph representing the PM Poshan scheme in action" style="
                    background-image: url('@Model.AboutUs.KCMImageThumb');
                  "></div>
            </div>
        </div>
    </div>
</section>


<!-- Who is Who Section -->
<section class="py-16 md:py-24 bg-background-alt" id="who-is-who">
    <div class="container mx-auto max-w-5xl px-4">
        <h2 class="text-center text-3xl font-bold text-primary md:text-4xl">
            Who is Who
        </h2>

        <div class="mt-12 grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3 justify-items-center">
            <div class="flex flex-col items-center gap-3 text-center">
                <div class="w-36 h-36 bg-center bg-no-repeat aspect-square bg-cover rounded-full shadow-md"
                     data-alt="Portrait of the Hon'ble Chief Minister" style="
                    background-image: url('@Model.CM.KCMImageThumb');
                  "></div>
                <div>
                    <p class="font-semibold text-text-body">
                        @Model.CM.KCMContentName
                        


                    </p>
                    <p class="text-sm text-text-body/80">
                        @Html.Raw(WebUtility.HtmlDecode(@Model.CM.KCMContent))
                    </p>
                </div>
            </div>
            <div class="flex flex-col items-center gap-3 text-center">
                <div class="w-36 h-36 bg-center bg-no-repeat aspect-square bg-cover rounded-full shadow-md"
                     data-alt="Portrait of the Hon'ble Governor" style="
                    background-image: url('@Model.Governor.KCMImageThumb');
                  "></div>
                <div>
                    <p class="font-semibold text-text-body">
                        @Model.Governor.KCMContentName
                    </p>
                    <p class="text-sm text-text-body/80">
                        @Html.Raw(WebUtility.HtmlDecode(@Model.Governor.KCMContent))
                    </p>
                </div>
            </div>
            <div class="flex flex-col items-center gap-3 text-center">
                <div class="w-36 h-36 bg-center bg-no-repeat aspect-square bg-cover rounded-full shadow-md"
                     data-alt="Portrait of the Education Minister" style="
                    background-image: url('@Model.G20.KCMImageThumb');
                  "></div>
                <div>
                    <p class="font-semibold text-text-body">
                        @Model.G20.KCMContentName
                    </p>
                    <p class="text-sm text-text-body/80">
                        @Html.Raw(WebUtility.HtmlDecode(@Model.G20.KCMContent))
                    </p>
                </div>
            </div>
            
        </div>
    </div>
</section>

<!-- Latest Rates and Links -->
<section class="py-16 md:py-24 bg-background-light" id="rates-links">
    <div class="container mx-auto max-w-5xl px-4 grid grid-cols-1 gap-12 lg:grid-cols-2 lg:gap-16">
        <div>
            <h2 class="text-3xl font-bold text-primary md:text-4xl">
                @Model.LatestRates.KCMContentName


            </h2>
            <div class="rate-content">
                @Html.Raw(WebUtility.HtmlDecode(Model.LatestRates.KCMContent))
            </div>

            @* <div class="mt-6 overflow-x-auto rounded-lg border">
                <table class="w-full text-left text-sm">
                    <thead class="bg-background-alt text-text-body">
                        <tr>
                            <th class="px-6 py-3 font-semibold" scope="col">Level</th>
                            <th class="px-6 py-3 font-semibold" scope="col">
                                Cooking Cost per Child
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-t">
                            <td class="px-6 py-4">Primary (Classes I-V)</td>
                            <td class="px-6 py-4">₹ 5.45</td>
                        </tr>
                        <tr class="border-t">
                            <td class="px-6 py-4">Upper Primary (Classes VI-VIII)</td>
                            <td class="px-6 py-4">₹ 8.17</td>
                        </tr>
                    </tbody>
                </table>
            </div> *@
        </div>
        <div>
            <h2 class="text-3xl font-bold text-primary md:text-4xl">
                Important Links
            </h2>

            <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">

                @if (Model.Links != null && Model.Links.Any())
                {
                    foreach (var item in Model.Links)
                    {
                        <a href="@item.Link" target="_blank" rel="noopener noreferrer"
                           class="group flex items-center justify-between w-full p-2.5 rounded-lg
                          backdrop-blur border border-white/20 bg-white/40 dark:bg-white/10
                          hover:bg-white/60 hover:shadow-sm transition-all duration-200">

                            <span class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-secondary text-base group-hover:text-secondary transition-colors">
                                    link
                                </span>

                                <span class="text-xs text-text-body/80
                                     group-hover:text-secondary dark:group-hover:text-primary transition-colors">
                                    @item.LinkTitle
                                </span>
                            </span>

                            <span class="material-symbols-outlined text-gray-400 text-sm opacity-60
                                 group-hover:opacity-100 group-hover:text-secondary transition-all">
                                arrow_outward
                            </span>
                        </a>
                    }
                }

            </div>
        </div>

        
    </div>
</section>
<!-- Our Objective and Our Approach Section -->

<section class="py-16 md:py-24 bg-background-alt" id="objective-approach">
    <div class="container mx-auto max-w-6xl px-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-14">

            <!-- OUR OBJECTIVE -->
            <div class="group rounded-2xl shadow-md hover:shadow-xl transition-shadow duration-300 p-6 md:p-8">
                <div class="aspect-video rounded-xl bg-cover bg-center mb-6"
                     style="background-image:url('@Model.Objectives.KCMImageThumb');">
                </div>
                <h2 class="text-3xl font-bold text-primary md:text-4xl">@Model.Objectives.KCMContentName</h2>
                <p class="mt-4 text-base leading-relaxed text-text-body">
                    @Html.Raw(WebUtility.HtmlDecode(Model.Objectives.KCMContent))

                   
                </p>
            </div>

            <!-- OUR APPROACH -->
            <div class="group rounded-2xl shadow-md hover:shadow-xl transition-shadow duration-300 p-6 md:p-8">
                <div class="aspect-video rounded-xl bg-cover bg-center mb-6"
                     style="background-image:url('@Model.Approaches.KCMImageThumb');">
                </div>
                <h2 class="text-3xl font-bold text-primary md:text-4xl">@Model.Approaches.KCMContentName</h2>
                <p class="mt-4 text-base leading-relaxed text-text-body">
                    @Html.Raw(WebUtility.HtmlDecode(Model.Approaches.KCMContent))

                    
                </p>
            </div>

        </div>
    </div>
</section>


<!-- Events Section -->
<section class="py-16 md:py-24 bg-background-light" id="events">
    <div class="container mx-auto max-w-5xl px-4 grid grid-cols-1 gap-12 lg:grid-cols-2 lg:gap-16">

        <div>
            <h2 class="text-3xl font-bold text-primary md:text-4xl">
                Events
            </h2>
            <div class="mt-6 space-y-4">
                <div id="eventsListContainer">
                    @await Html.PartialAsync("_EventsPartial", Model.Events)
                </div>

                
                
            </div>
        </div>
        <div>
            <h2 class="text-3xl font-bold text-primary md:text-4xl">
                Notifications
            </h2>
            <!-- Using ViewData -->
          

            <div class="mt-6 space-y-4">

                <div id="notifications-container">
                    @await Html.PartialAsync("_NotificationsPartial", Model.Notifications)
                </div>



            </div>

            
        </div>
    </div>
</section>

@* fsa *@




<!---->


<!-- Photo Gallery Section -->




<section class="py-16 md:py-24 bg-background-alt" id="gallery">
    <div class="container mx-auto max-w-5xl px-4">
        <h2 class="text-center text-3xl font-bold text-primary md:text-4xl">
            Gallery
        </h2>

        <div class="flex items-center justify-center gap-4 mb-10 mt-8">
            <button class="gallery-tab active px-6 py-2 rounded-full border border-primary text-primary font-medium hover:bg-primary hover:text-white transition" data-target="all">
                All
            </button>
            <button class="gallery-tab px-6 py-2 rounded-full border border-primary text-primary font-medium hover:bg-primary hover:text-white transition" data-target="photos">
                Photos
            </button>
            <button class="gallery-tab px-6 py-2 rounded-full border border-primary text-primary font-medium hover:bg-primary hover:text-white transition" data-target="videos">
                Videos
            </button>
        </div>


        <!-- PHOTOS GRID -->
        <div id="photosGrid" class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-4 gap-4 mt-6">
            @if (Model.PhotoAlbums?.Albums != null)
            {
                foreach (var album in Model.PhotoAlbums.Albums)
                {
                    <a href="/photos/photogallery?albumId=@album.PhotoAlbumID" target="_blank" rel="noopener noreferrer" class="group block" title="@album.PhotoAlbumDesc">

                    <div class="relative w-full aspect-video rounded-lg overflow-hidden">
                    <div class="h-32 md:h-40 w-full bg-cover bg-center rounded-lg transition-transform duration-300 group-hover:scale-105"
                         style="background-image: url('@album.CoverThumb');"
                         title="@album.PhotoAlbumDesc">
                    </div>
                    </div>
                    </a>
                }
            }
        </div>

        <!-- VIDEOS GRID (Hidden by default) -->
        <div id="videosGrid" class="hidden grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-4 gap-4 mt-6">
            @if (Model.VideoAlbums?.Albums != null)
            {
                foreach (var video in Model.VideoAlbums.Albums)
                {
                    var thumbnail = YoutubeHelper.GetYoutubeThumbnail(video.VideoCoverLink);

                    <a href="/videos/videogallery?albumId=@video.VideoAlbumID" target="_blank" rel="noopener noreferrer" class="group block" title="@video.VideoAlbumDesc">
                        <div class="relative w-full aspect-video rounded-lg overflow-hidden">
                            <div class="w-full h-full bg-center bg-no-repeat bg-cover transition-transform duration-300 group-hover:scale-105"
                                 style='background-image: url("@thumbnail");'>
                            </div>

                            <!-- Play Overlay -->
                            <div class="absolute inset-0 bg-black/30 flex items-center justify-center">
                                <span class="material-symbols-outlined text-white text-5xl opacity-80 group-hover:opacity-100 transition-opacity">
                                    play_circle
                                </span>
                            </div>
                        </div>
                    </a>
                }
            }
        </div>



        @* <div id="videosGrid" class="hidden grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-4 gap-4 mt-6">
            @if (Model.VideoAlbums?.Albums != null)
            {
                foreach (var video in Model.VideoAlbums.Albums)
                {
                    <div class="h-32 md:h-40 w-full bg-cover bg-center rounded-lg relative"
                         style="background-image: url('@video.VideoCoverLink');"
                         title="@video.VideoAlbumDesc">

                        <!-- Play icon overlay -->
                        <div class="absolute inset-0 bg-black/40 flex items-center justify-center text-white text-3xl">
                            <i class="mdi mdi-play-circle"></i>
                        </div>
                    </div>
                }
            }
        </div> *@

        <div id="viewMoreWrapper" class="flex justify-center mt-8">
            <button id="viewMoreBtn"
                    class="relative z-[2] flex h-12 min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-xl px-5 bg-accent text-white text-base font-bold hover:scale-105">
                View More
            </button>
        </div>

        



    </div>
</section>






<script>
    document.querySelectorAll('.gallery-tab').forEach(btn => {
        btn.addEventListener('click', () => {
            const type = btn.getAttribute('data-target');

            document.querySelectorAll('.gallery-tab').forEach(x => x.classList.remove('active'));
            btn.classList.add('active');

            document.getElementById('photosGrid').classList.toggle('hidden', type !== 'all' && type !== 'photos');
            document.getElementById('videosGrid').classList.toggle('hidden', type !== 'all' && type !== 'videos');

            const viewMore = document.getElementById('viewMoreWrapper');
            if (type === 'all') viewMore.classList.add('hidden');
            else viewMore.classList.remove('hidden');
        });
    });

    // **Trigger default state on load**
    document.querySelector('.gallery-tab.active').click();

    document.getElementById('viewMoreBtn').addEventListener('click', function () {
        const activeTab = document.querySelector('.gallery-tab.active')?.getAttribute('data-target');

        if (activeTab === 'photos') {
            window.location.href = '/photos?pageNo=1';
        }
        else if (activeTab === 'videos') {
            window.location.href = '/videos?pageNo=1';
        }
        else {
            window.location.href = '/photos?pageNo=1';
        }
    });
</script>

